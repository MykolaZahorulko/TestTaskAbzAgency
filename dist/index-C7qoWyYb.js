(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function t(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function a(o){if(o.ep)return;o.ep=!0;const r=t(o);fetch(o.href,r)}})();function x(){let n=document.querySelectorAll(".ibg");for(let e=0;e<n.length;e++)n[e].querySelector("img")&&(n[e].style.backgroundImage="url("+n[e].querySelector("img").getAttribute("src")+")")}async function y(n){try{const e=await fetch(n);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return await e.json()}catch(e){return console.debug("Fetch error:",e),null}}async function L(n,e=null,t=null){const a={};t&&(a.Token=t);try{const o=await fetch(n,{method:"POST",body:e,headers:a});if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return await o.json()}catch(o){return console.debug("Fetch error:",o),null}}function b(n,e){const t=document.querySelector(".post__body");n.addEventListener("submit",a);async function a(s){if(s.preventDefault(),o(n)===0)try{let f=new FormData(n);n.classList.add("_sending");const v=(await y("https://frontend-test-assignment-api.abz.agency/api/v1/token")).token;await L("https://frontend-test-assignment-api.abz.agency/api/v1/users",f,v)?(n.reset(),e.classList.remove("error"),n.classList.remove("_sending"),t.classList.add("_sended")):(alert("Something went wrong, try again"),n.classList.remove("_sending"))}catch{alert("Something went wrong, try again"),n.classList.remove("_sending")}}function o(s){let d=0;return s.querySelectorAll("._req").forEach(i=>{c(i),i.classList.contains("_email")?_(i)||(r(i),d++):i.classList.contains("_phone")?h(i)||(r(i),d++):i.classList.contains("_photo")?g(i.files[0])||(r(i),d++):(i.value.length<2||i.value.length>60)&&(r(i),d++)}),d}function r(s){s.classList.add("error"),s.parentElement.classList.add("error")}function c(s){s.classList.remove("error"),s.parentElement.classList.remove("error")}function _(s){return/^(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])$/.test(s.value)}function h(s){return/^[\+]{0,1}380([0-9]{9})$/.test(s.value)}const l=document.querySelector(".file__input"),u=document.querySelector(".upload-your-photo");l.addEventListener("change",()=>{const s=l.files[0];g(s),u.innerHTML=s.name,u.style.color="black"});function g(s){return c(l),u.innerHTML=s.name,["image/jpeg","image/jpg","image/png","image/tiff","image/gif"].includes(s.type)?s.size>5*70*70?(r(l),!1):!0:(r(l),l.value="",!1)}}function S(n,e){n.addEventListener("input",function(){n.value.trim()===""?e.classList.remove("error"):e.classList.add("error")})}function w(){document.querySelectorAll("[data-goto]").forEach(function(e){e.addEventListener("click",function(t){t.preventDefault();const a=this.getAttribute("data-goto"),o=document.querySelector(a);if(o){const r=document.querySelector("header"),c=o.offsetTop-r.offsetHeight;window.scrollTo({top:c,behavior:"smooth"})}})})}let m=[];document.addEventListener("DOMContentLoaded",async()=>{x(),w();let e="https://frontend-test-assignment-api.abz.agency/api/v1/users?page=1&count=6";const t=document.querySelector("._email"),a=t.nextElementSibling;await p(e),document.querySelector(".get__button").addEventListener("click",async()=>{e&&(e=await p(e))});const r=document.querySelector(".form");b(r,a),S(t,a)});async function p(n){const e=document.querySelector(".get__content");e.classList.add("_loading");const t=await y(n);return t&&t.users?(m=[...m,...t.users],q(t.users),e.classList.remove("_loading"),t.links.next_url?(document.querySelector(".get__button").style.display="flex",t.links.next_url):(document.querySelector(".get__button").style.display="none",null)):(document.querySelector(".get__button").style.display="none",null)}function q(n){n.sort((t,a)=>new Date(a.created_at)-new Date(t.created_at));const e=document.querySelector(".get__content");n.forEach(t=>{const a=document.createElement("div");a.className="get__user",a.innerHTML=`
            <div class="get__user-image img" >
                <img src="${t.photo}" alt="${t.name}">    
            </div>
            <div class="get__user-name" data-title="${t.name}">
                <span class="get__user-span">${t.name}
                <span class="get__user-popap">${t.name}</span>
                </span>
            </div>
            <div class="get__user-position" data-title="${t.position}">${t.position}</div>
            <div class="get__user-email" data-title="${t.email}">
                <span class="get__user-span">${t.email}
                <span class="get__user-popap">${t.email}</span>
                </span>
            </div>
            <div class="get__user-phone" data-title="${t.phone}">${t.phone}</div>
        `,e.appendChild(a)})}
